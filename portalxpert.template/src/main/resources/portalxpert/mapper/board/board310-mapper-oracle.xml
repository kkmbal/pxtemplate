<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="portalxpert.board.board310.mapper.Board310Mapper">
		
	<!-- 개인 게시물_정보 -->	
	<resultMap id="pbsUserNotiInfoResult" type="portalxpert.board.board300.vo.PbsUserNotiInfoVO">
		<result property="userNotiSeq" column="USER_NOTI_SEQ" />
		<result property="upUserNotiSeq" column="UP_USER_NOTI_SEQ" />
		<result property="boardId" column="BOARD_ID" />
		<result property="emgcYn" column="EMGC_YN" />
		<result property="anmtYn" column="ANMT_YN" />
		<result property="popupYn" column="POPUP_YN" />
		<result property="briefYn" column="BRIEF_YN" />
		<result property="moblOpenDiv" column="MOBL_OPEN_DIV" />
		<result property="notiTitle" column="NOTI_TITLE" />
		<result property="titleBoldYn" column="TITLE_BOLD_YN" />
		<result property="titleColorDiv" column="TITLE_COLOR_DIV" />
		<result property="notiConts" column="NOTI_CONTS" />
		<result property="linkUrl" column="LINK_URL" />
		<result property="notiTp" column="NOTI_TP" />
		<result property="notiKind" column="NOTI_KIND" />
		<result property="nickUseYn" column="NICK_USE_YN" />
		<result property="userNick" column="USER_NICK" />
		<result property="userName" column="USER_NAME" />
		<result property="editDiv" column="EDIT_DIV" />
		<result property="rsrvYn" column="RSRV_YN" />
		<result property="notiBgnDttm" column="NOTI_BGN_DTTM" />
		<result property="notiEndDttm" column="NOTI_END_DTTM" />
		<result property="notiOpenDiv" column="NOTI_OPEN_DIV" />
		<result property="notiOpenDivSpec" column="NOTI_OPEN_DIV_SPEC" />
		<result property="publAsgnDiv" column="PUBL_ASGN_DIV" />
		<result property="publAsgnDivSpec" column="PUBL_ASGN_DIV_SPEC" />
		<result property="replyPrmsYn" column="REPLY_PRMS_YN" />
		<result property="replyMakrRealnameYn" column="REPLY_MAKR_REALNAME_YN" />
		<result property="opnPrmsYn" column="OPN_PRMS_YN" />
		<result property="opnMakrRealnameYn" column="OPN_MAKR_REALNAME_YN" />
		<result property="notiReadCnt" column="NOTI_READ_CNT" />
		<result property="notiOpnCnt" column="NOTI_OPN_CNT" />
		<result property="notiAgrmCnt" column="NOTI_AGRM_CNT" />
		<result property="notiOppCnt" column="NOTI_OPP_CNT" />
		<result property="notiLikeCnt" column="NOTI_LIKE_CNT" />
		<result property="statCode" column="STAT_CODE" />
		<result property="deptCode" column="DEPT_CODE" />
		<result property="deptName" column="DEPT_NAME" />
		<result property="deptFname" column="DEPT_FNAME" />
		<result property="makrIp" column="MAKR_IP" />
		<result property="delYn" column="DEL_YN" />
		<result property="regrId" column="REGR_ID" />
		<result property="regrName" column="REGR_NAME" />
		<result property="regDttm" column="REG_DTTM" />
		<result property="updrId" column="UPDR_ID" />
		<result property="updrName" column="UPDR_NAME" />
		<result property="updDttm" column="UPD_DTTM" />
		<result property="evalReadCnt" column="EVAL_READ_CNT" />
		<result property="notiReadCnt" column="NOTI_READ_CNT" />
		<result property="apndFileCnt" column="APND_FILE_CNT" />
		<result property="mail" column="MAIL" />
		<result property="opnCnt" column="OPN_CNT" />
		<result property="evalAgrmCnt" column="EVAL_AGRM_CNT" />
		<result property="evalOppCnt" column="EVAL_OPP_CNT" />
		<result property="evalLikeCnt" column="EVAL_LIKE_CNT" />
		<result property="prevNotiId" column="PREV_NOTI_ID" />
		<result property="prevNotiTitle" column="PREV_NOTI_TITLE" />
		<result property="nextNotiId" column="NEXT_NOTI_ID" />
		<result property="nextNotiTitle" column="NEXT_NOTI_TITLE" />
		<result property="notiTagLst" column="NOTI_TAG_LST" />
		<result property="agrmOppYn" column="AGRM_OPP_YN" />
		<result property="noticeSeq" column="NOTICE_SEQ" />	
		<result property="prevNotiKind" column="PREV_NOTI_KIND" />
		<result property="nextNotiKind" column="NEXT_NOTI_KIND" />
		<result property="nextLinkUrl" column="NEXT_LINK_URL" />
		<result property="prevLinkUrl" column="PREV_LINK_URL" />
		<result property="boardFormSpec" column="BOARD_FORM_SPEC" />
		<result property="notiReadmanAsgnYn" column="NOTI_READMAN_ASGN_YN" />	
		
	</resultMap>
	
	<!-- 게인게시글 조회 -->
	<select id="getPbsNotiUserInfoListForPaging" resultMap="pbsUserNotiInfoResult" parameterType="portalxpert.common.vo.BoardSearchVO" >
			SELECT
		          	   (SELECT COUNT(USER_NOTI_SEQ) FROM PBS_USER_NOTI_APND_FILE WHERE DEL_YN = 'N' AND USER_NOTI_SEQ = N.USER_NOTI_SEQ AND APND_FILE_TP = '050') APND_FILE_CNT
		             , (SELECT COUNT(USER_NOTI_SEQ) FROM PBS_USER_NOTI_OPN WHERE DEL_YN = 'N' AND USER_NOTI_SEQ = N.USER_NOTI_SEQ) OPN_CNT
		             , NVL((SELECT 'Y' FROM DUAL WHERE EXISTS (SELECT 1 FROM PBS_USER_NOTI_EVAL_INFO WHERE USER_NOTI_SEQ = N.USER_NOTI_SEQ AND USER_ID = #{userId} AND NOTI_EVAL_DIV = '040')), 'N') AS NOTI_READ_YN  
					 , N.*   
		        FROM(
		        SELECT   		 <![CDATA[
		                        CASE WHEN UP_USER_NOTI_SEQ = 0 THEN
		                             NOTI_TITLE
		                        ELSE
		                             LPAD('@!', 2 * (LEVEL-1),'@!') || '<img src="../resources/images/img/replyarrow.gif"/>&nbsp;'  ||NOTI_TITLE
		                        END AS NOTI_TITLE              
		                        , ROWNUM PNUM
		                        ]]>
		                        , USER_NOTI_SEQ
		                        , UP_USER_NOTI_SEQ
		                        , BOARD_ID
		                        , EMGC_YN
		                        , ANMT_YN
		                        , POPUP_YN
		                        , BRIEF_YN
		                        , MOBL_OPEN_DIV
		                        , TITLE_BOLD_YN
		                        , TITLE_COLOR_DIV
		                        , LINK_URL
		                        , NOTI_TP
		                        , NOTI_KIND
		                        , NICK_USE_YN
		                        , USER_NICK
		                        , USER_NAME
		                        , EDIT_DIV
		                        , RSRV_YN
		                        , TO_CHAR (NOTI_BGN_DTTM, 'yyyy-mm-dd') NOTI_BGN_DTTM
		                        , TO_CHAR (NOTI_END_DTTM, 'yyyy-mm-dd') NOTI_END_DTTM
		                        , NOTI_OPEN_DIV
		                        , NOTI_OPEN_DIV_SPEC
		                        , PUBL_ASGN_DIV
		                        , PUBL_ASGN_DIV_SPEC
		                        , REPLY_PRMS_YN
		                        , REPLY_MAKR_REALNAME_YN
		                        , OPN_PRMS_YN
		                        , OPN_MAKR_REALNAME_YN
		                        , NOTI_READ_CNT
		                        , NOTI_AGRM_CNT
		                        , NOTI_OPP_CNT
		                        , NOTI_LIKE_CNT    
									<![CDATA[		                                             
		                        ,     CASE WHEN REG_DTTM < UPD_DTTM THEN 'Y' 
		                              WHEN  REG_DTTM =  UPD_DTTM THEN 'N' 
		                              ELSE 'X'
		                              END UPD_YN
		                              ]]>
		                        , STAT_CODE
		                        , DEPT_CODE
		                        , DEPT_NAME
		                        , DEPT_FNAME
		                        , MAKR_IP
		                        , DEL_YN
		                        , REGR_ID
		                        , REGR_NAME
		                        , TO_CHAR(REG_DTTM,'yyyy-mm-dd') REG_DTTM             
		                        , UPDR_ID
		                        , UPDR_NAME
		                        , UPD_DTTM
		                        , NOTICE_SEQ
		                    FROM (
		                            SELECT A.*
		                            FROM PBS_USER_NOTI_INFO A 
		                            WHERE DEL_YN='N' 
		                            AND BOARD_ID = #{boardId}
		                            <![CDATA[	
		                            AND (NOTI_BGN_DTTM <= SYSDATE  OR (RSRV_YN = 'Y' AND REGR_ID = #{userId} AND REG_DTTM <= SYSDATE)) 
		                            AND NOTI_END_DTTM >= SYSDATE-1
		                            ]]>
		                            <if test="searchCondition !=null and searchCondition !=''">
			                            <if test="searchKeyword !=null and searchKeyword !=''">
			                            	<if test="!searchCondition.equalsIgnoreCase('MY_NOTI_TITLE') ">
			                            		/* 키워드 검색 */
												AND ${searchCondition} LIKE '%' || #{searchKeyword} || '%'
											</if>
											<if test="searchCondition.equalsIgnoreCase('MY_NOTI_TITLE') ">
			                            		/* 내게시글 검색 */
			                            		AND REGR_ID = #{userId}
			                            		AND NOTI_TITLE LIKE '%' || #{searchKeyword} || '%'
			                            	</if>
			                            </if>
			                        </if>	                       
			                        <if test="regDttmFrom != null and regDttmFrom != '' ">/* 기간 */
			                        	<![CDATA[
			                            AND TO_CHAR(REG_DTTM,'yyyymmdd') > #{regDttmFrom}]]>	
			                        </if>
			                        <if test="regDttmTo != null and regDttmTo != '' ">
			                        	<![CDATA[
			                        	AND TO_CHAR(REG_DTTM,'yyyymmdd') < #{regDttmTo}]]>	
			                        </if>
		                            AND EXISTS(
		                            			SELECT 1
		                                         FROM PBS_USER_BOARD_PART_INFO B
		                                        WHERE A.BOARD_ID = B.BOARD_ID
		                                          AND B.USER_ID IN 
		                                          (${userMap})
		                                       )
		                            <if test="searchCondition !=null and searchCondition !=''">
			                            <if test="searchKeyword !=null and searchKeyword !=''">
			                            ORDER BY UPD_DTTM DESC
			                            </if>
			                        </if>  
		                            ) X 
			<if test="searchKeyword == null or searchKeyword ==''">	                        
				START WITH UP_USER_NOTI_SEQ = 0 
				CONNECT BY PRIOR   USER_NOTI_SEQ = UP_USER_NOTI_SEQ				
				<if test="orderType != null and orderType.equalsIgnoreCase('default') ">
					ORDER SIBLINGS BY ANMT_YN DESC , UPD_DTTM DESC
				</if>
				<if test="orderType != null and !orderType.equalsIgnoreCase('default') ">
					<if test="orderType != null and orderType.equalsIgnoreCase('notiTitle') ">
						ORDER SIBLINGS BY TRIM(NOTI_TITLE_ORGN)
					</if>
					<if test="orderType != null and orderType.equalsIgnoreCase('regrName') ">
						ORDER SIBLINGS BY REGR_NAME
					</if>
					<if test="orderType != null and orderType.equalsIgnoreCase('deptName') ">
						ORDER SIBLINGS BY DEPT_NAME
					</if>
					<if test="orderType != null and orderType.equalsIgnoreCase('notiBgnDttm') ">
						 ORDER SIBLINGS BY NOTI_BGN_DTTM 
					</if>
					<if test="orderType != null and orderType.equalsIgnoreCase('notiEndDttm') ">
						 ORDER SIBLINGS BY NOTI_END_DTTM 
					</if>
					<if test="orderType != null and orderType.equalsIgnoreCase('notiReadCnt') ">
						 ORDER SIBLINGS BY NOTI_READ_CNT 
					</if>
					<if test="isDesc != true ">
						 DESC
					</if>
				</if>
			</if>
		) N
		WHERE PNUM BETWEEN #{firstIndex} + 1 AND #{firstIndex} + #{recordCountPerPage}
		ORDER BY PNUM  		
		
	</select>
	
	<!-- 개인게시판 게시글 총 개수 -->
	<select id="getPbsUserNotiInfoListTotCnt" parameterType="portalxpert.board.board300.vo.PbsUserNotiInfoVO" 
	    	resultType="int">
		<![CDATA[
		SELECT COUNT(*) CNT
		FROM PBS_USER_NOTI_INFO A 
		WHERE BOARD_ID = #{boardId} AND DEL_YN = 'N'
		AND (NOTI_BGN_DTTM <= SYSDATE  OR (RSRV_YN = 'Y' AND REGR_ID = #{userId} AND REG_DTTM <= SYSDATE)) 
		AND NOTI_END_DTTM >= SYSDATE-1
		]]>
        <if test="searchCondition !=null and searchCondition !=''">
			<if test="searchKeyword !=null and searchKeyword !=''">
				<if test="!searchCondition.equalsIgnoreCase('MY_NOTI_TITLE') ">
					/* 키워드 검색 */
					AND ${searchCondition} LIKE '%' || #{searchKeyword} || '%'
				</if>
				<if test="searchCondition.equalsIgnoreCase('MY_NOTI_TITLE') ">
					/* 내게시글 검색 */
					AND REGR_ID = #{userId}
					AND NOTI_TITLE LIKE '%' || #{searchKeyword} || '%'
				</if>
			</if>
		</if>		
		<if test="regDttmFrom != null and regDttmFrom != '' ">/* 기간 */
			<![CDATA[
			AND TO_CHAR(REG_DTTM,'yyyymmdd') > #{regDttmFrom}]]>	
		</if>
		<if test="regDttmTo != null and regDttmTo != '' ">
			<![CDATA[
			AND TO_CHAR(REG_DTTM,'yyyymmdd') < #{regDttmTo}]]>	
		</if>               		
		AND EXISTS(SELECT 1
                   FROM PBS_USER_BOARD_PART_INFO B
                   WHERE A.BOARD_ID = B.BOARD_ID
                   AND B.USER_ID IN (${userMap}))
	   
	</select> 	
	
	<!-- 게시글 상세보기 -->
	<select id="getPbsUserNotiInfoList" resultMap="pbsUserNotiInfoResult" 
	parameterType="portalxpert.board.board300.vo.PbsUserNotiInfoVO" >
	
		SELECT X.AGRM_OPP_YN,
		       X.NOTI_TITLE,
		       X.USER_NOTI_SEQ,
		       X.UP_USER_NOTI_SEQ,
		       X.BOARD_ID,
		       X.EMGC_YN,
		       X.ANMT_YN,
		       X.POPUP_YN,
		       X.BRIEF_YN,
		       X.MOBL_OPEN_DIV,
		       X.NOTI_TITLE_ORGN,
		       X.TITLE_BOLD_YN,
		       X.TITLE_COLOR_DIV,
		       X.NOTI_CONTS,
		       X.LINK_URL,
		       X.NOTI_TP,
		       X.NOTI_KIND,
		       X.NICK_USE_YN,
		       X.USER_ID,
		       X.USER_NICK,
		       X.USER_NAME,
		       X.EDIT_DIV,
		       X.RSRV_YN,
		       TO_CHAR(X.NOTI_BGN_DTTM, 'yyyy-mm-dd hh24:mi') NOTI_BGN_DTTM,
		       TO_CHAR(X.NOTI_END_DTTM, 'yyyy-mm-dd') NOTI_END_DTTM,
		       X.NOTI_OPEN_DIV,
		       X.NOTI_OPEN_DIV_SPEC,
		       X.PUBL_ASGN_DIV,
		       X.PUBL_ASGN_DIV_SPEC,
		       X.REPLY_PRMS_YN,
		       X.REPLY_MAKR_REALNAME_YN,
		       X.OPN_PRMS_YN,
		       X.OPN_MAKR_REALNAME_YN,
		       X.NOTI_READ_CNT,
		       X.NOTI_OPN_CNT,
		       X.NOTI_AGRM_CNT,
		       X.NOTI_OPP_CNT,
		       X.NOTI_LIKE_CNT,
		       X.STAT_CODE,
		       X.DEPT_CODE,
		       X.DEPT_NAME,
		       X.DEPT_FNAME,
		       X.MAKR_IP,
		       X.DEL_YN,
		       X.REGR_ID,
		       X.REGR_NAME,
		       TO_CHAR(X.REG_DTTM, 'yyyy-mm-dd') REG_DTTM,
		       X.UPDR_ID,
		       X.UPDR_NAME,
		       X.UPD_DTTM,
		       X.NOTI_TAG_LST,
		       X.NOTICE_SEQ,
		       Z.BOARD_FORM_SPEC,
		       Z.NOTI_READMAN_ASGN_YN,
		       (SELECT COUNT(USER_NOTI_SEQ)
		        FROM PBS_USER_NOTI_OPN
		        WHERE USER_NOTI_SEQ = X.USER_NOTI_SEQ
		          AND DEL_YN = 'N') OPN_CNT,
		       NOTI_EVAL_DIV_10 AS EVAL_AGRM_CNT,
		       NOTI_EVAL_DIV_20 AS EVAL_OPP_CNT,
		       NOTI_EVAL_DIV_30 AS EVAL_LIKE_CNT,
		       NOTI_EVAL_DIV_40 AS EVAL_READ_CNT,
		       CASE WHEN Z.NICK_USE_YN = 'Y' AND Z.OPN_REALNAME_DIV != '010' THEN 'Y'
		            ELSE 'N'
		       END IP_OPEN_YN , 
		       (SELECT MAIL FROM PSN_USER_INFO WHERE RESINUMBER = X.USER_ID) MAIL
		FROM PBS_USER_NOTI_INFO X,
		     (SELECT A.USER_NOTI_SEQ,
		             SUM(CASE 
		                   WHEN NOTI_EVAL_DIV = '010' THEN 1
		                   ELSE 0
		                 END) NOTI_EVAL_DIV_10,
		             SUM(CASE 
		                   WHEN NOTI_EVAL_DIV = '020' THEN 1
		                   ELSE 0
		                 END) NOTI_EVAL_DIV_20,
		             SUM(CASE 
		                   WHEN NOTI_EVAL_DIV = '030' THEN 1
		                   ELSE 0
		                 END) NOTI_EVAL_DIV_30,
		             SUM(CASE 
		                   WHEN NOTI_EVAL_DIV = '040' THEN 1
		                   ELSE 0
		                 END) NOTI_EVAL_DIV_40
		      FROM PBS_USER_NOTI_INFO A,
		           PBS_USER_NOTI_EVAL_INFO B
		      WHERE A.USER_NOTI_SEQ  = B.USER_NOTI_SEQ(+)
		        AND A.USER_NOTI_SEQ  = #{userNotiSeq}
		        AND A.DEL_YN   = 'N'
		        AND A.BOARD_ID = #{boardId}
		      GROUP BY A.USER_NOTI_SEQ) Y,
		      PBS_USER_BOARD_INFO Z  
		 WHERE X.USER_NOTI_SEQ  = Y.USER_NOTI_SEQ
		   AND X.BOARD_ID = Z.BOARD_ID
	
	</select>
	
	<!-- 게시글 내용 조회 -->
	<select id="getPbsUserNotiInfoViewForNotiConts" resultType="portalxpert.board.board100.vo.BbsNotiInfoVO" parameterType="int">
		
		SELECT NOTI_CONTS, REGR_ID FROM PBS_USER_NOTI_INFO WHERE USER_NOTI_SEQ = #{userNotiSeq}
	
	</select>
	
	<!-- PBS_게시물_첨부_파일 -->
	<select id="getBbsNotiApndFileList" parameterType="portalxpert.board.board300.vo.PbsUserNotiApndFileVO"
		resultType="portalxpert.board.board300.vo.PbsUserNotiApndFileVO">
		SELECT USER_NOTI_SEQ
				, APND_FILE_SEQ
				, APND_FILE_TP
				, APND_FILE_SZ
				, APND_FILE_ORGN
				, APND_FILE_NAME
				, APND_FILE_PATH
				, APND_FILE_PRVW_PATH
				, APND_FILE_PRVW_NAME
				, SOURCE_CODE_INPUT
				, DEL_YN
				, REGR_ID
				, REGR_NAME
				, REG_DTTM
				, UPDR_ID
				, UPDR_NAME
				, UPD_DTTM
				, MVP_KEY
		FROM PBS_USER_NOTI_APND_FILE
		WHERE USER_NOTI_SEQ = #{userNotiSeq}
		AND DEL_YN='N' 
		
	</select>
	
	<!-- PNUM으로 이전글 다음글 조회 -->
	<select id="getPbsPrevNextNotiInfo" resultMap="pbsUserNotiInfoResult" 
		parameterType="portalxpert.board.board300.vo.PbsUserNotiInfoVO">
		SELECT MAX (PREV_USER_NOTI_SEQ) PREV_NOTI_ID,
           MAX (PREV_NOTI_TITLE) PREV_NOTI_TITLE,
           MAX (NEXT_USER_NOTI_SEQ) NEXT_NOTI_ID,
           MAX (NEXT_NOTI_TITLE) NEXT_NOTI_TITLE,
           MAX (NEXT_NOTI_KIND) NEXT_NOTI_KIND,
           MAX (PREV_NOTI_KIND) PREV_NOTI_KIND,
           MAX (PREV_LINK_URL) PREV_LINK_URL,
           MAX (NEXT_LINK_URL) NEXT_LINK_URL
          FROM (SELECT DECODE (RNUM, ${prevPnum}, USER_NOTI_SEQ) PREV_USER_NOTI_SEQ,
                   DECODE (RNUM, ${prevPnum}, NOTI_TITLE) PREV_NOTI_TITLE,
                   DECODE (RNUM, ${nextPnum}, USER_NOTI_SEQ) NEXT_USER_NOTI_SEQ,
                   DECODE (RNUM, ${nextPnum}, NOTI_TITLE) NEXT_NOTI_TITLE,
                   DECODE (RNUM, ${nextPnum}, NOTI_KIND) NEXT_NOTI_KIND,
                   DECODE (RNUM, ${prevPnum}, NOTI_KIND) PREV_NOTI_KIND,
                   DECODE (RNUM, ${prevPnum}, LINK_URL) PREV_LINK_URL,
                   DECODE (RNUM, ${nextPnum}, LINK_URL) NEXT_LINK_URL
              FROM (SELECT UP_USER_NOTI_SEQ,
                           ANMT_YN,
                           USER_NOTI_SEQ,
                           NOTI_TITLE,
                           UPD_DTTM,
                           RNUM, NOTI_KIND, LINK_URL
                      FROM (           SELECT UP_USER_NOTI_SEQ,
                                              ANMT_YN,
                                              USER_NOTI_SEQ,
                                              NOTI_TITLE,
                                              UPD_DTTM,
                                              ROWNUM RNUM, NOTI_KIND, LINK_URL
                                         FROM (SELECT UP_USER_NOTI_SEQ,  ANMT_YN, USER_NOTI_SEQ
                                         		, NOTI_TITLE, UPD_DTTM
                                         		, NOTI_KIND, LINK_URL 
                                                FROM PBS_USER_NOTI_INFO A
                                                WHERE     BOARD_ID = #{boardId}
                                                      AND DEL_YN = 'N'
                                                       <![CDATA[
                                                         AND (NOTI_BGN_DTTM <= SYSDATE  OR (RSRV_YN = 'Y' AND REGR_ID = #{userId} AND REG_DTTM <= SYSDATE))
                                                         AND NOTI_END_DTTM >= SYSDATE-1
                                                         ]]>
                                                      AND EXISTS
                                                             (SELECT 1
                                                                FROM PBS_USER_BOARD_PART_INFO B
                                                               WHERE A.BOARD_ID = B.BOARD_ID
                                                                     AND B.USER_ID IN
                                                                            (${userMap})))
                                   START WITH UP_USER_NOTI_SEQ = 0 
                                CONNECT BY PRIOR  USER_NOTI_SEQ = UP_USER_NOTI_SEQ
                            ORDER SIBLINGS BY ANMT_YN DESC, UPD_DTTM DESC)
                     WHERE RNUM IN (${prevPnum},${nextPnum})))
	</select>
	
	<!-- PBS 게시물 의견 정보 -->
	<select id="getPbsUserNotiOpnList1" parameterType="portalxpert.board.board300.vo.PbsUserNotiOpnVO"
		resultType="portalxpert.board.board300.vo.PbsUserNotiOpnVO">
		SELECT USER_NOTI_SEQ
			, USER_NOTI_OPN_SEQ
			, UP_OPN_SEQ
			, OPN_CONTS
			, USER_ID
			, USER_NAME
			, USER_NICK
			, DEPT_CODE
			, DEPT_NAME
			, MAKE_IP
			, ADMIN_DEL
			, DEL_YN
			, REGR_ID
			, REGR_NAME
			, TO_CHAR( REG_DTTM,'yyyy-mm-dd hh24:mi') REG_DTTM
			, UPDR_ID
			, UPDR_NAME
			, UPD_DTTM
		FROM PBS_USER_NOTI_OPN
		WHERE USER_NOTI_SEQ = #{userNotiSeq} 
		AND DEL_YN='N'
		AND UP_OPN_SEQ IS NULL
		ORDER BY 2 DESC
		
	</select>
	
	<!-- PBS 게시물 의견의 의견 정보 -->
	<select id="getPbsUserNotiOpnList2" parameterType="portalxpert.board.board300.vo.PbsUserNotiOpnVO"
										resultType="portalxpert.board.board300.vo.PbsUserNotiOpnVO">
										
		SELECT (ROW_NUMBER() OVER(PARTITION BY UP_OPN_SEQ  ORDER BY USER_NOTI_OPN_SEQ )) RANK 
		    , USER_NOTI_SEQ
			, USER_NOTI_OPN_SEQ
			, UP_OPN_SEQ
			, OPN_CONTS
			, USER_ID
			, USER_NAME
			, USER_NICK
			, DEPT_CODE
			, DEPT_NAME
			, MAKE_IP
			, ADMIN_DEL
			, DEL_YN
			, REGR_ID
			, REGR_NAME
			, TO_CHAR( REG_DTTM,'yyyy-mm-dd hh24:mi') REG_DTTM
			, UPDR_ID
			, UPDR_NAME
			, UPD_DTTM
		FROM PBS_USER_NOTI_OPN
		WHERE USER_NOTI_SEQ = #{userNotiSeq} 
		AND UP_OPN_SEQ IS NOT NULL
		AND DEL_YN='N'
		ORDER BY USER_NOTI_OPN_SEQ ASC
		
	</select>
	
	<!-- 상세보기시 의견등록 -->
	<insert id="insertPbsUserNotiOpn" parameterType="portalxpert.board.board300.vo.PbsUserNotiOpnVO">
		<selectKey keyProperty="userNotiOpnSeq" resultType="int" order="BEFORE" >
			SELECT  NVL(MAX(USER_NOTI_OPN_SEQ)+1,1)  userNotiOpnSeq 
			FROM  PBS_USER_NOTI_OPN 
			WHERE USER_NOTI_SEQ = #{userNotiSeq}
		</selectKey>
		INSERT INTO PBS_USER_NOTI_OPN(
			 USER_NOTI_SEQ
			, USER_NOTI_OPN_SEQ
			<if test="upOpnSeq != 0 "> , UP_OPN_SEQ</if>
			, OPN_CONTS
			, USER_ID
			, USER_NAME
			, USER_NICK
			, DEPT_CODE
			, DEPT_NAME
			, MAKE_IP
			, ADMIN_DEL
			, DEL_YN
			, REGR_ID
			, REGR_NAME
			, REG_DTTM
			, UPDR_ID
			, UPDR_NAME
			, UPD_DTTM
		) VALUES (
			 #{userNotiSeq}
			, #{userNotiOpnSeq}
			<if test="upOpnSeq != 0 "> , #{upOpnSeq}</if>
			, #{opnConts}
			, #{userId}
			, #{userName}
			, #{userNick}
			, #{deptCode}
			, #{deptName}
			, #{makeIp}
			, 'N'
			, 'N'
			, #{regrId}
			, #{regrName}
			, sysdate
			, #{updrId}
			, #{updrName}
			, sysdate
		)
	</insert>
				
	<!-- 의견 수정 -->					
	<update id="updatePbsUserNotiOpn" parameterType="portalxpert.board.board300.vo.PbsUserNotiOpnVO">
		
		<![CDATA[
		UPDATE PBS_USER_NOTI_OPN SET UPDR_ID = #{updrId}
		, UPD_DTTM = sysdate
		, DEL_YN = 'N'
		, ADMIN_DEL = 'N'
		]]>
		<if test="upOpnSeq != null and upOpnSeq != ''"> , UP_OPN_SEQ = #{upOpnSeq} </if>
		<if test="opnConts != null and opnConts != ''"> , OPN_CONTS = #{opnConts} </if>
		<if test="userId != null and userId != ''"> , USER_ID = #{userId} </if>
		<if test="userName != null and userName != ''"> , USER_NAME = #{userName} </if>
		<if test="userNick != null and userNick != ''"> , USER_NICK = #{userNick} </if>
		<if test="deptCode != null and deptCode != ''"> , DEPT_CODE = #{deptCode} </if>
		<if test="deptName != null and deptName != ''"> , DEPT_NAME = #{deptName} </if>
		<if test="makeIp != null and makeIp != ''"> , MAKE_IP = #{makeIp} </if>
		<if test="regrName != null and regrName != ''"> , REGR_NAME = #{regrName} </if>
		<if test="updrName != null and updrName != ''"> , UPDR_NAME = #{updrName} </if>
		WHERE USER_NOTI_SEQ = #{userNotiSeq}
		AND USER_NOTI_OPN_SEQ = #{userNotiOpnSeq}
	</update>		
	
	<!-- 의견 삭제 -->					
	<update id="deletePbsUserNotiOpn" parameterType="portalxpert.board.board300.vo.PbsUserNotiOpnVO">
		UPDATE PBS_USER_NOTI_OPN SET DEL_YN='Y' 
		WHERE USER_NOTI_SEQ = #{userNotiSeq}
		AND USER_NOTI_OPN_SEQ = #{userNotiOpnSeq}								
	</update>
	
	<select id="getUserNotiReadCnt" resultType = "int" >
		
		SELECT COUNT(1) readCnt FROM 
				PBS_USER_NOTI_EVAL_INFO 
				WHERE NOTI_EVAL_DIV = '040' 
				AND USER_NOTI_SEQ = #{userNotiSeq}
				AND USER_ID = #{userId}
	</select>
	
	<!-- 게시글 상세보기시 조회수 올리기 -->
	<insert id="insertPbsUserNotiEvalInfo" parameterType="portalxpert.board.board300.vo.PbsUserNotiEvalInfoVO">
		INSERT INTO PBS_USER_NOTI_EVAL_INFO(
                  USER_NOTI_SEQ
				, NOTI_EVAL_DIV
				, USER_ID
				, USER_NAME
				, EVAL_DTTM
				, DEL_YN
				, REGR_ID
				, REGR_NAME
				, REG_DTTM
				, UPDR_ID
				, UPDR_NAME
				, UPD_DTTM
			)
			VALUES( 
				  #{userNotiSeq}
				, #{notiEvalDiv}
				, #{userId}
				, #{userName}
				, sysdate
				, 'N'
				, #{regrId}
				, #{regrName}
				, SYSDATE
				, #{updrId}
				, #{updrName}
				, SYSDATE
			)
	
	</insert>
	
	<!-- 게시글 읽음처리 -->
	<update id="updatePbsUserNotiEvalInfoForRead" parameterType="portalxpert.board.board300.vo.PbsUserNotiEvalInfoVO" >
		MERGE INTO PBS_USER_NOTI_EVAL_INFO MU
		USING 
		(
		        SELECT COUNT(*) CNT FROM PBS_USER_NOTI_EVAL_INFO 
		        WHERE USER_NOTI_SEQ = #{userNotiSeq}          
		        AND NOTI_EVAL_DIV = '040' 
		        AND USER_ID = #{userId}
		) M
		ON ( M.CNT > 0)
		WHEN MATCHED THEN
		        UPDATE SET UPDR_ID = #{updrId}, UPD_DTTM = sysdate
		        , USER_NAME = #{userName} 
		        , EVAL_DTTM = sysdate 
		        , DEL_YN = 'N'
		        , REGR_NAME = #{regrName} 
		        , UPDR_NAME = #{updrName} 
		        WHERE USER_NOTI_SEQ = #{userNotiSeq}             
		        AND NOTI_EVAL_DIV = '040'
		        AND USER_ID = #{userId}
		WHEN NOT MATCHED THEN
		        INSERT (
		         USER_NOTI_SEQ
		        , NOTI_EVAL_DIV
		        , USER_ID
		        , USER_NAME
		        , EVAL_DTTM
		        , DEL_YN
		        , REGR_ID
		        , REGR_NAME
		        , REG_DTTM
		        , UPDR_ID
		        , UPDR_NAME
		        , UPD_DTTM
		        ) VALUES (
		        #{userNotiSeq}
		        , '040'
		        , #{userId}
		        , #{userName}
		        , sysdate
		        , 'N'
		        , #{regrId}
		        , #{regrName}
		        , sysdate
		        , #{updrId}
		        , #{updrName}
		        , sysdate
		        )
	</update>
	
	<!-- 게시글 이동 개인:개인 -->
	<insert id="insertPbsUserNotiInfoForMove" parameterType="portalxpert.board.board100.vo.BbsNotiInfoVO">
	
		INSERT INTO PBS_USER_NOTI_INFO
		(
			USER_NOTI_SEQ,
			UP_USER_NOTI_SEQ, 
			BOARD_ID, 
			EMGC_YN, 
			ANMT_YN, 
			POPUP_YN, 
			BRIEF_YN, 
			MOBL_OPEN_DIV, 
			NOTI_TITLE, 
			NOTI_TITLE_ORGN, 
			TITLE_BOLD_YN, 
			TITLE_COLOR_DIV, 
			NOTI_CONTS, 
			LINK_URL, 
			NOTI_TP, 
			NOTI_KIND, 
			NICK_USE_YN, 
			USER_ID, 
			USER_NICK, 
			USER_NAME, 
			EDIT_DIV, 
			RSRV_YN, 
			NOTI_BGN_DTTM, 
			NOTI_END_DTTM, 
			NOTI_OPEN_DIV, 
			NOTI_OPEN_DIV_SPEC, 
			PUBL_ASGN_DIV, 
			PUBL_ASGN_DIV_SPEC, 
			REPLY_PRMS_YN, 
			REPLY_MAKR_REALNAME_YN, 
			OPN_PRMS_YN, 
			OPN_MAKR_REALNAME_YN, 
			NOTI_READ_CNT, 
			NOTI_OPN_CNT, 
			NOTI_AGRM_CNT, 
			NOTI_OPP_CNT, 
			NOTI_LIKE_CNT, 
			NOTI_TAG_LST, 
			STAT_CODE, 
			DEPT_CODE, 
			DEPT_NAME, 
			DEPT_FNAME, 
			MAKR_IP, 
			DEL_YN, 
			REGR_ID, 
			REGR_NAME, 
			REG_DTTM, 
			UPDR_ID, 
			UPDR_NAME, 
			UPD_DTTM, 
			AGRM_OPP_YN, 
			NOTICE_SEQ		
		)
		SELECT
		       #{maxUserNotiSeq}                                                                                              
		     , A.UP_USER_NOTI_SEQ                                                                                           
		     , #{boardId}                                                                                      
		     , A.EMGC_YN                                                                                                    
		     , A.ANMT_YN                                                                                                    
		     , A.POPUP_YN                                                                                                   
		     , A.BRIEF_YN                                                                                                   
		     , A.MOBL_OPEN_DIV   
		     , A.NOTI_TITLE     
		     , A.NOTI_TITLE_ORGN                                                                                            
		     , A.TITLE_BOLD_YN                                                                                              
		     , A.TITLE_COLOR_DIV                                                                                            
		     , A.NOTI_CONTS                                                                                                 
		     , A.LINK_URL
		     , A.NOTI_TP                                                                                                    
		     , A.NOTI_KIND                                                                                                  
		     , A.NICK_USE_YN                                                                                                
		     , A.USER_ID                                                                                                    
		     , A.USER_NICK                                                                                                  
		     , A.USER_NAME                                                                                                  
		     , A.EDIT_DIV                                                                                                   
		     , A.RSRV_YN                                                                                                    
		     , A.NOTI_BGN_DTTM                                                                                              
		     , A.NOTI_END_DTTM                                                                                              
		     , A.NOTI_OPEN_DIV                                                                                              
		     , A.NOTI_OPEN_DIV_SPEC                                                                                         
		     , A.PUBL_ASGN_DIV                                                                                              
		     , A.PUBL_ASGN_DIV_SPEC                                                                                         
		     , A.REPLY_PRMS_YN                                                                                              
		     , A.REPLY_MAKR_REALNAME_YN                                                                                     
		     , A.OPN_PRMS_YN                                                                                                
		     , A.OPN_MAKR_REALNAME_YN                                                                                       
		     , A.NOTI_READ_CNT                                                                                              
		     , A.NOTI_OPN_CNT                                                                                               
		     , A.NOTI_AGRM_CNT                                                                                              
		     , A.NOTI_OPP_CNT                                                                                               
		     , A.NOTI_LIKE_CNT                                                                                              
		     , A.NOTI_TAG_LST                                                                                               
		     , A.STAT_CODE                                                                                                  
		     , A.DEPT_CODE                                                                                                  
		     , A.DEPT_NAME                                                                                                  
		     , A.DEPT_FNAME                                                                                                 
		     , A.MAKR_IP                                                                                                    
		     , A.DEL_YN                                                                                                     
		     , A.REGR_ID                                                                                                    
		     , A.REGR_NAME                                                                                                  
		     , SYSDATE                                                                                                   
		     , A.UPDR_ID                                                                                                    
		     , A.UPDR_NAME                                                                                                  
		     , SYSDATE       
		     , A.AGRM_OPP_YN    
		     , (SELECT NVL(MAX(TO_NUMBER(NOTICE_SEQ)), 0) + 1 FROM PBS_USER_NOTI_INFO WHERE BOARD_ID = #{boardId})                                                                                        
		  FROM PBS_USER_NOTI_INFO A
		 WHERE A.USER_NOTI_SEQ = #{userNotiSeq}
	</insert>
	
	<select id="getMaxUserNotiSeq" resultType="int">
		
		SELECT SEQ_NOTI_INFO.NEXTVAL As userNotiSeq
			FROM DUAL
						
	</select> 
	
	<insert id="insertPbsUserNotiApndFileForScrapFromBbs" parameterType="portalxpert.board.board300.vo.PbsUserNotiInfoVO">
	
		INSERT INTO PBS_USER_NOTI_APND_FILE
		SELECT
		       #{maxUserNotiSeq}                                                                                                         
		     , A.APND_FILE_SEQ                                                                                                  
		     , A.APND_FILE_TP                                                                                                   
		     , A.APND_FILE_SZ                                                                                                   
		     , A.APND_FILE_ORGN                                                                                                 
		     , A.APND_FILE_NAME                                                                                                 
		     , A.APND_FILE_PATH                                                                                                 
		     , A.APND_FILE_PRVW_PATH                                                                                            
		     , A.APND_FILE_PRVW_NAME                                                                                            
		     , A.SOURCE_CODE_INPUT                                                                                                                                                                                                                             
		     , A.DEL_YN                                                                                                         
		     , A.REGR_ID                                                                                                        
		     , A.REGR_NAME                                                                                                      
		     , A.REG_DTTM                                                                                                       
		     , A.UPDR_ID                                                                                                        
		     , A.UPDR_NAME                                                                                                      
		     , A.UPD_DTTM                                                                                                       
		     , A.MVP_KEY                                                                                                        
		  FROM BBS_NOTI_APND_FILE A 
		 WHERE A.NOTI_ID       = #{notiId}
	</insert>
	
	
	<insert id="insertPbsUserNotiApndFileForScrapFromPbs" parameterType="portalxpert.board.board300.vo.PbsUserNotiInfoVO">
	
		INSERT INTO PBS_USER_NOTI_APND_FILE   
		SELECT
		       #{maxUserNotiSeq}                                                                                                  
		     , A.APND_FILE_SEQ                                                                                                  
		     , A.APND_FILE_TP                                                                                                   
		     , A.APND_FILE_SZ                                                                                                   
		     , A.APND_FILE_ORGN                                                                                                 
		     , A.APND_FILE_NAME                                                                                                 
		     , A.APND_FILE_PATH                                                                                                 
		     , A.APND_FILE_PRVW_PATH                                                                                            
		     , A.APND_FILE_PRVW_NAME                                                                                            
		     , A.SOURCE_CODE_INPUT                                                                                              
		     , A.DEL_YN                                                                                                         
		     , A.REGR_ID                                                                                                        
		     , A.REGR_NAME                                                                                                      
		     , A.REG_DTTM                                                                                                       
		     , A.UPDR_ID                                                                                                        
		     , A.UPDR_NAME                                                                                                      
		     , A.UPD_DTTM                                                                                                       
		     , A.MVP_KEY                                                                                                        
		  FROM PBS_USER_NOTI_APND_FILE A 
		 WHERE A.USER_NOTI_SEQ = #{userNotiSeq}
	</insert>
	
	<!-- 공용 게시글 스크랩  -->
	<insert id="insertPbsUserNotiInfoForScrapFromBbs" parameterType="portalxpert.board.board300.vo.PbsUserNotiInfoVO">
		
		INSERT INTO PBS_USER_NOTI_INFO
		( 
			USER_NOTI_SEQ
			,UP_USER_NOTI_SEQ
			,BOARD_ID
			,EMGC_YN
			,ANMT_YN
			,POPUP_YN
			,BRIEF_YN
			,MOBL_OPEN_DIV
			,NOTI_TITLE
			,NOTI_TITLE_ORGN
			,TITLE_BOLD_YN
			,TITLE_COLOR_DIV
			,NOTI_CONTS
			,LINK_URL
			,NOTI_TP
			,NOTI_KIND
			,NICK_USE_YN
			,USER_ID
			,USER_NICK
			,USER_NAME
			,EDIT_DIV
			,RSRV_YN
			,NOTI_BGN_DTTM
			,NOTI_END_DTTM
			,NOTI_OPEN_DIV
			,NOTI_OPEN_DIV_SPEC
			,PUBL_ASGN_DIV
			,PUBL_ASGN_DIV_SPEC
			,REPLY_PRMS_YN
			,REPLY_MAKR_REALNAME_YN
			,OPN_PRMS_YN
			,OPN_MAKR_REALNAME_YN
			,NOTI_READ_CNT
			,NOTI_OPN_CNT
			,NOTI_AGRM_CNT
			,NOTI_OPP_CNT
			,NOTI_LIKE_CNT
			,NOTI_TAG_LST
			,STAT_CODE
			,DEPT_CODE
			,DEPT_NAME
			,DEPT_FNAME
			,MAKR_IP
			,DEL_YN
			,REGR_ID
			,REGR_NAME
			,REG_DTTM
			,UPDR_ID
			,UPDR_NAME
			,UPD_DTTM
			,AGRM_OPP_YN
			,NOTICE_SEQ		
		)
		SELECT
		      #{maxUserNotiSeq}                                                                                         
		     , '0'                                                                                                                                                                                                    
		     , #{boardId}                                                                                                    
		     , A.EMGC_YN                                                                                                          
		     , A.ANMT_YN                                                                                                          
		     , A.POPUP_YN                                                                                                         
		     , A.BRIEF_YN                                                                                                         
		     , A.MOBL_OPEN_DIV                                                                                                    
		     , #{notiTitle}                                                                                                     
		     , #{notiTitle}                                                                                                 
		     , A.TITLE_BOLD_YN                                                                                                    
		     , A.TITLE_COLOR_DIV                                                                                                  
		     , A.NOTI_CONTS  
		     <if test="linkUrl != null and linkUrl != '' ">                                                                                                     
		     , #{linkUrl}              
		     </if>                                         
		     <if test="linkUrl == null or linkUrl == '' ">
		     , A.LINK_URL
		     </if>                                                      
		     , A.NOTI_TP   
		     <if test="notiKind != null and notiKind != '' ">
		     , #{notiKind} 
		     </if>
		     <if test="notiKind == null or notiKind == '' ">                                                                                                       
		     , A.NOTI_KIND                                
		     </if>                                                                          
		     , A.NICK_USE_YN                                                                                                      
		     , #{regrId}                                                                                                        
		     , #{userNick}                                                                                                     
		     , #{regrName}                                                                                                        
		     , A.EDIT_DIV                                                                                                         
		     , A.RSRV_YN                                                                                                          
		     , SYSDATE /* 게시시작일 */                                                                                                    
		     , TO_DATE(TO_CHAR(ADD_MONTHS(SYSDATE, +1), 'YYYY-MM-DD')||'23:59:59', 'YYYY-MM-DD HH24:MI:SS') /* 게시종료일 */                                                                                                 
		     , A.NOTI_OPEN_DIV                                                                                                    
		     , A.NOTI_OPEN_DIV_SPEC                                                                                               
		     , A.PUBL_ASGN_DIV                                                                                                    
		     , A.PUBL_ASGN_DIV_SPEC                                                                                               
		     , A.REPLY_PRMS_YN                                                                                                    
		     , A.REPLY_MAKR_REALNAME_YN                                                                                           
		     , A.OPN_PRMS_YN                                                                                                      
		     , A.OPN_MAKR_REALNAME_YN                                                                                                                                                                  
		     , 0                                                                                                    
		     , 0                                                                                                     
		     , 0                                                                                                    
		     , 0                                                                                                     
		     , 0
		     , A.NOTI_TAG_LST                                                                                                                                                                                                              
		     , A.STAT_CODE                                                                                                        
		     , #{deptCode}                                                                                                        
		     , #{deptName}                                                                                                        
		     , #{deptFname}                                                                                                       
		     , A.MAKR_IP                                                                                                                                                                                                                                                                                                          
		     , A.DEL_YN                                                                                                           
		     , #{regrId}                                                                                                          
		     , #{regrName}                                                                                                        
		     , SYSDATE                                                                                                         
		     , #{updrId}                                                                                                          
		     , #{updrName}                                                                                                        
		     , SYSDATE        
		     , A.AGRM_OPP_YN        
		     , (SELECT NVL(MAX(TO_NUMBER(NOTICE_SEQ)), 0) + 1 FROM PBS_USER_NOTI_INFO WHERE BOARD_ID = #{boardId})                                                                                                                                                                                      
		  FROM BBS_NOTI_INFO A 
		 WHERE A.NOTI_ID       = #{notiId}  
		 
	</insert>
	
	<!-- 개인 게시글 스크랩 -->
	<insert id="insertPbsUserNotiInfoForScrapFromPbs" parameterType="portalxpert.board.board100.vo.BbsNotiInfoVO">
		
		INSERT INTO PBS_USER_NOTI_INFO
		(
			USER_NOTI_SEQ
			,UP_USER_NOTI_SEQ
			,BOARD_ID
			,EMGC_YN
			,ANMT_YN
			,POPUP_YN
			,BRIEF_YN
			,MOBL_OPEN_DIV
			,NOTI_TITLE
			,NOTI_TITLE_ORGN
			,TITLE_BOLD_YN
			,TITLE_COLOR_DIV
			,NOTI_CONTS
			,LINK_URL
			,NOTI_TP
			,NOTI_KIND
			,NICK_USE_YN
			,USER_ID
			,USER_NICK
			,USER_NAME
			,EDIT_DIV
			,RSRV_YN
			,NOTI_BGN_DTTM
			,NOTI_END_DTTM
			,NOTI_OPEN_DIV
			,NOTI_OPEN_DIV_SPEC
			,PUBL_ASGN_DIV
			,PUBL_ASGN_DIV_SPEC
			,REPLY_PRMS_YN
			,REPLY_MAKR_REALNAME_YN
			,OPN_PRMS_YN
			,OPN_MAKR_REALNAME_YN
			,NOTI_READ_CNT
			,NOTI_OPN_CNT
			,NOTI_AGRM_CNT
			,NOTI_OPP_CNT
			,NOTI_LIKE_CNT
			,NOTI_TAG_LST
			,STAT_CODE
			,DEPT_CODE
			,DEPT_NAME
			,DEPT_FNAME
			,MAKR_IP
			,DEL_YN
			,REGR_ID
			,REGR_NAME
			,REG_DTTM
			,UPDR_ID
			,UPDR_NAME
			,UPD_DTTM
			,AGRM_OPP_YN
			,NOTICE_SEQ		
		)
		SELECT
		      #{maxUserNotiSeq}                                                                                           
		     , '0'                                                                                                                                                                                                    
		     , #{boardId}                                                                                                    
		     , A.EMGC_YN                                                                                                          
		     , A.ANMT_YN                                                                                                          
		     , A.POPUP_YN                                                                                                         
		     , A.BRIEF_YN                                                                                                         
		     , A.MOBL_OPEN_DIV                                                                                                    
		     , #{notiTitle}                                                                                                     
		     , #{notiTitle}                                                                                                    
		     , A.TITLE_BOLD_YN                                                                                                    
		     , A.TITLE_COLOR_DIV                                                                                                  
		     , A.NOTI_CONTS  
		     <if test="linkUrl != null and linkUrl != '' ">                                                                                                     
		     , #{linkUrl}              
		     </if>                                         
		     <if test="linkUrl == null or linkUrl == '' ">
		     , A.LINK_URL
		     </if>                                                      
		     , A.NOTI_TP   
		     <if test="notiKind != null and notiKind != '' ">
		     , #{notiKind} 
		     </if>
		     <if test="notiKind == null or notiKind == '' ">                                                                                                       
		     , A.NOTI_KIND                                
		     </if>                                                                          
		     , A.NICK_USE_YN                                                                                                      
		     , #{regrId}                                                                                                          
		     , #{userNick}                                                                                                     
		     , #{regrName}                                                                                                        
		     , A.EDIT_DIV                                                                                                         
		     , A.RSRV_YN                                                                                                          
   		     , SYSDATE /* 게시시작일 */                                                                                                    
		     , TO_DATE(TO_CHAR(ADD_MONTHS(SYSDATE, +1), 'YYYY-MM-DD')||'23:59:59', 'YYYY-MM-DD HH24:MI:SS') /* 게시종료일 */                                                                                                    
		     , A.NOTI_OPEN_DIV                                                                                                    
		     , A.NOTI_OPEN_DIV_SPEC                                                                                               
		     , A.PUBL_ASGN_DIV                                                                                                    
		     , A.PUBL_ASGN_DIV_SPEC                                                                                               
		     , A.REPLY_PRMS_YN                                                                                                    
		     , A.REPLY_MAKR_REALNAME_YN                                                                                           
		     , A.OPN_PRMS_YN                                                                                                      
		     , A.OPN_MAKR_REALNAME_YN                                                                                                                                                                  
		     , 0                                                                                                    
		     , 0                                                                                                     
		     , 0                                                                                                    
		     , 0                                                                                                     
		     , 0
		     , A.NOTI_TAG_LST                                                                                                                                                                                                              
		     , A.STAT_CODE                                                                                                        
		     , #{deptCode}                                                                                                        
		     , #{deptName}                                                                                                        
		     , #{deptFname}                                                                                                       
		     , A.MAKR_IP                                                                                                                                                                                                                                                                                                          
		     , A.DEL_YN                                                                                                           
		     , #{regrId}                                                                                                          
		     , #{regrName}                                                                                                        
		     , SYSDATE                                                                                                         
		     , #{updrId}                                                                                                          
		     , #{updrName}                                                                                                        
		     , SYSDATE       
		     , A.AGRM_OPP_YN         
		     , (SELECT NVL(MAX(TO_NUMBER(NOTICE_SEQ)), 0) + 1 FROM PBS_USER_NOTI_INFO WHERE BOARD_ID = #{boardId})                                                                                                                                                                                   
		  FROM PBS_USER_NOTI_INFO A 
		 WHERE A.USER_NOTI_SEQ       = #{userNotiSeq}  
		 
	</insert>
	
	<!-- 유저별 게시글별 건수 -->
	<select id="getMyPbsNotiCheckList" 
	    	resultType="int">
			SELECT COUNT(USER_NOTI_SEQ) cnt  FROM PBS_USER_NOTI_INFO 
			<where>
	        	USER_NOTI_SEQ IN
	        	<foreach collection="list" item="item" index="index" separator="," open="(" close=")">
	            #{item}
	        	</foreach>
    		</where>
    		AND REGR_ID != #{regrId}
	</select>
	
	<insert id="insertPbsUserNotiApndFileForMove" parameterType="portalxpert.board.board300.vo.PbsUserNotiInfoVO">

		INSERT INTO PBS_USER_NOTI_APND_FILE
		(
			USER_NOTI_SEQ, 
			APND_FILE_SEQ, 
			APND_FILE_TP, 
			APND_FILE_SZ, 
			APND_FILE_ORGN, 
			APND_FILE_NAME, 
			APND_FILE_PATH, 
			APND_FILE_PRVW_PATH, 
			APND_FILE_PRVW_NAME, 
			SOURCE_CODE_INPUT, 
			DEL_YN, 
			REGR_ID, 
			REGR_NAME, 
			REG_DTTM, 
			UPDR_ID, 
			UPDR_NAME, 
			UPD_DTTM, 
			MVP_KEY		
		)
		SELECT
		       #{maxUserNotiSeq}                                                                                                  
		     , A.APND_FILE_SEQ                                                                                                  
		     , A.APND_FILE_TP                                                                                                   
		     , A.APND_FILE_SZ                                                                                                   
		     , A.APND_FILE_ORGN                                                                                                 
		     , A.APND_FILE_NAME                                                                                                 
		     , A.APND_FILE_PATH                                                                                                 
		     , A.APND_FILE_PRVW_PATH                                                                                            
		     , A.APND_FILE_PRVW_NAME                                                                                            
		     , A.SOURCE_CODE_INPUT                                                                                              
		     , A.DEL_YN                                                                                                         
		     , A.REGR_ID                                                                                                        
		     , A.REGR_NAME                                                                                                      
		     , A.REG_DTTM                                                                                                       
		     , A.UPDR_ID                                                                                                        
		     , A.UPDR_NAME                                                                                                      
		     , SYSDATE                                                                                                       
		     , A.MVP_KEY                                                                                                        
		  FROM PBS_USER_NOTI_APND_FILE A 
		 WHERE A.USER_NOTI_SEQ = #{userNotiSeq}
   	</insert>
   	
   	<insert id="insertPbsUserNotiEvalForMove" parameterType="portalxpert.board.board300.vo.PbsUserNotiInfoVO">

		INSERT INTO PBS_USER_NOTI_EVAL_INFO
		(
			USER_NOTI_SEQ, 
			NOTI_EVAL_DIV, 
			USER_ID, 
			USER_NAME, 
			EVAL_DTTM, 
			DEL_YN, 
			REGR_ID, 
			REGR_NAME, 
			REG_DTTM, 
			UPDR_ID, 
			UPDR_NAME, 
			UPD_DTTM		
		)
		SELECT
		       #{maxUserNotiSeq}                                                                                                    
		     , A.NOTI_EVAL_DIV                                                                                                   
		     , A.USER_ID                                                                                                         
		     , A.USER_NAME                                                                                                       
		     , A.EVAL_DTTM                                                                                                       
		     , A.DEL_YN                                                                                                          
		     , A.REGR_ID                                                                                                         
		     , A.REGR_NAME                                                                                                       
		     , A.REG_DTTM                                                                                                        
		     , A.UPDR_ID                                                                                                         
		     , A.UPDR_NAME                                                                                                       
		     , SYSDATE                                                                                                       
		  FROM PBS_USER_NOTI_EVAL_INFO A 
		 WHERE A.USER_NOTI_SEQ = #{userNotiSeq}
		 
 	</insert>

	<insert id="insertPbsUserNotiOpnForMove" parameterType="portalxpert.board.board300.vo.PbsUserNotiInfoVO">
		
		INSERT INTO PBS_USER_NOTI_OPN
		(
			USER_NOTI_SEQ, 
			USER_NOTI_OPN_SEQ, 
			UP_OPN_SEQ, 
			OPN_CONTS, 
			USER_ID, 
			USER_NAME, 
			USER_NICK, 
			DEPT_CODE, 
			DEPT_NAME, 
			MAKE_IP, 
			ADMIN_DEL, 
			DEL_YN, 
			REGR_ID, 
			REGR_NAME, 
			REG_DTTM, 
			UPDR_ID, 
			UPDR_NAME, 
			UPD_DTTM		
		)
		SELECT
		       #{maxUserNotiSeq}                                                                                               
		     , A.USER_NOTI_OPN_SEQ                                                                                                         
		     , A.UP_OPN_SEQ                                                                                                      
		     , A.OPN_CONTS                                                                                                       
		     , A.USER_ID                                                                                                         
		     , A.USER_NAME                                                                                                       
		     , A.USER_NICK                                                                                                       
		     , A.DEPT_CODE                                                                                                       
		     , A.DEPT_NAME                                                                                                       
		     , A.MAKE_IP                                                                                                         
		     , A.ADMIN_DEL                                                                                                       
		     , A.DEL_YN                                                                                                          
		     , A.REGR_ID                                                                                                         
		     , A.REGR_NAME                                                                                                       
		     , A.REG_DTTM                                                                                                        
		     , A.UPDR_ID                                                                                                         
		     , A.UPDR_NAME                                                                                                       
		     , SYSDATE                                                                                                        
		  FROM PBS_USER_NOTI_OPN A 
		 WHERE A.USER_NOTI_SEQ = #{userNotiSeq}
 
 	</insert>
 	
<!--  	게시글 삭제 -->
	<update id="deletePbsUserNotiInfoForBoard" parameterType="portalxpert.board.board300.vo.PbsUserNotiInfoVO">
		
		UPDATE PBS_USER_NOTI_INFO 
        SET UPDR_ID = #{updrId}
        , UPD_DTTM = SYSDATE
        , UPDR_NAME = #{updrName}
        , DEL_YN='Y' 
        WHERE 
        USER_NOTI_SEQ IN
		<foreach collection="list" item="item" index="index" separator="," open="(" close=")">
           #{item}
       	</foreach>
		
	</update>
	
<!-- 	게시글 첨부파일 삭제 -->
	<update id="deletePbsUserNotiApndFileForBoard" parameterType="portalxpert.board.board300.vo.PbsUserNotiInfoVO">
		
		UPDATE PBS_USER_NOTI_APND_FILE 
        SET UPDR_ID = #{updrId}
        , UPD_DTTM = SYSDATE
        , UPDR_NAME = #{updrName}
        , DEL_YN='Y' 
        WHERE 
        USER_NOTI_SEQ IN
		<foreach collection="list" item="item" index="index" separator="," open="(" close=")">
           #{item}
       	</foreach>
		
	</update>
	
<!-- 	게시글 평가 삭제 -->
	<update id="deletePbsUserNotiEvalInfoForBoard" parameterType="portalxpert.board.board300.vo.PbsUserNotiInfoVO">
		
		UPDATE PBS_USER_NOTI_EVAL_INFO 
        SET UPDR_ID = #{updrId}
        , UPD_DTTM = SYSDATE
        , UPDR_NAME = #{updrName}
        , DEL_YN='Y' 
        WHERE 
        USER_NOTI_SEQ IN
		<foreach collection="list" item="item" index="index" separator="," open="(" close=")">
           #{item}
       	</foreach>
		
	</update>
	
<!-- 	게시글 의견 삭제 -->
	<update id="deletePbsUserNotiOpnForBoard" parameterType="portalxpert.board.board300.vo.PbsUserNotiInfoVO">
		
		UPDATE PBS_USER_NOTI_OPN 
        SET UPDR_ID = #{updrId}
        , UPD_DTTM = SYSDATE
        , UPDR_NAME = #{updrName}
        , DEL_YN='Y' 
        WHERE 
        USER_NOTI_SEQ IN
		<foreach collection="list" item="item" index="index" separator="," open="(" close=")">
           #{item}
       	</foreach>
		
	</update>
	
	<!-- 게시글 읽음, 찬성, 반대, 좋아요 올리기 -->
	<update id="updatePbsUserNotiInfoForCntPlus" parameterType="portalxpert.board.board300.vo.PbsUserNotiEvalInfoVO">
		UPDATE PBS_USER_NOTI_INFO SET 
		<if test="notiEvalDiv == '010' ">
			NOTI_AGRM_CNT = NVL(NOTI_AGRM_CNT,0)+1
		</if>
		<if test="notiEvalDiv == '020' ">
			NOTI_OPP_CNT = NVL(NOTI_OPP_CNT,0)+1
		</if>
		<if test="notiEvalDiv == '030' ">
			NOTI_LIKE_CNT = NVL(NOTI_LIKE_CNT,0)+1
		</if>
		<if test="notiEvalDiv == '040' ">
			NOTI_READ_CNT = NVL(NOTI_READ_CNT,0)+1
		</if>
		WHERE USER_NOTI_SEQ = #{userNotiSeq}
		 
	</update>
	
	<!-- 게시글 읽음 등록 건수 조회 -->
	<select id="getNotiReadCnt" resultType = "int" >
		
		SELECT COUNT(1) readCnt FROM 
				PBS_USER_NOTI_EVAL_INFO 
				WHERE NOTI_EVAL_DIV = '040' 
				AND USER_NOTI_SEQ = #{userNotiSeq}
				AND USER_ID = #{userId}
	</select>

	<select id="getTnMspMvpFileList" parameterType="String" 
		resultType="portalxpert.board.board100.vo.TbsNotiDelInfoVO">
		<![CDATA[
		SELECT T.MVP_KEY
			, SEQ_NO
			, MVP_SKEY
			, FORMT
			, TITLE_IMG_NO
			, RUN_TIME
			, ORGINL_FILE_NM
			, THUMB_TIME
			, STATE
			, MVP_FILE_NM
			, TITLE_FILE_NM
			, THUMB_FILE1
			, THUMB_FILE2
			, THUMB_FILE3
			, THUMB_FILE4
			, THUMB_FILE5
			, THUMB_FILE6
			, RGSDE
			, MVP_HIGH_FILE_NM
		FROM BBS_MVP_FILE T , PBS_USER_NOTI_APND_FILE A 
		WHERE T.MVP_KEY = A.MVP_KEY
		AND A.USER_NOTI_SEQ = #{userNotiSeq} 
		]]>
	</select>

	<!-- 게시글 PNUM 구하기 -->
	<select id="getPbsImgMoviePnumInfo" resultType="int" parameterType="portalxpert.board.board300.vo.PbsUserNotiInfoVO">	
		SELECT CASE WHEN COUNT(PNUM) > 0 THEN MAX(PNUM) ELSE 0 END PNUM
        FROM (  SELECT
                      ROW_NUMBER() OVER (ORDER BY UPD_DTTM DESC) PNUM, 
                      USER_NOTI_SEQ                   
                      FROM (SELECT A.*
                         FROM PBS_USER_NOTI_INFO A
                        WHERE     DEL_YN = 'N'
                              AND BOARD_ID = #{boardId}
                              <![CDATA[
                              AND (NOTI_BGN_DTTM <= SYSDATE  OR (RSRV_YN = 'Y' AND REGR_ID = #{userId} AND REG_DTTM <= SYSDATE))
                              AND NOTI_END_DTTM >= SYSDATE
                              ]]>
			                        AND EXISTS(SELECT 1 
	                        			 		FROM PBS_USER_BOARD_INFO C 
	                        				   WHERE A.BOARD_ID = C.BOARD_ID 
	                        			  		 AND C.BOARD_FORM_SPEC = #{boardFormSpec}) 
		                            AND EXISTS(
		                            			SELECT 1
		                                         FROM PBS_USER_BOARD_PART_INFO B
		                                        WHERE A.BOARD_ID = B.BOARD_ID
		                                          AND B.USER_ID IN 
		                                          (${userMap})
		                                       )
                              ) X
                              
		) N
        WHERE N.USER_NOTI_SEQ = #{userNotiSeq}
	
	</select>
		
	<!-- 이미지 동영상 게시물 이전 다음 정보 -->	
	<select id="getBbsMovieImagePrevNextNotiInfoForView" resultMap="pbsUserNotiInfoResult" parameterType="portalxpert.common.vo.BoardSearchVO" >
			SELECT
		<if test="boardFormSpec !=null and boardFormSpec.equalsIgnoreCase('010') ">
   		       (SELECT APND_FILE_PATH||'/'||APND_FILE_NAME FROM PBS_USER_NOTI_APND_FILE WHERE USER_NOTI_SEQ = N.USER_NOTI_SEQ AND APND_FILE_TP = '020' AND ROWNUM = 1) APND_FILE_NAME ,
		</if>
		<if test="boardFormSpec !=null and boardFormSpec.equalsIgnoreCase('020') ">
   		       (SELECT APND_FILE_PATH||'/'||APND_FILE_NAME FROM PBS_USER_NOTI_APND_FILE WHERE USER_NOTI_SEQ = N.USER_NOTI_SEQ AND APND_FILE_TP = '030' AND ROWNUM = 1) APND_FILE_NAME ,
		</if>			
		          	  (SELECT COUNT(USER_NOTI_SEQ) FROM PBS_USER_NOTI_APND_FILE WHERE DEL_YN = 'N' AND USER_NOTI_SEQ = N.USER_NOTI_SEQ AND APND_FILE_TP = '050') APND_FILE_CNT
		             , (SELECT COUNT(USER_NOTI_SEQ) FROM PBS_USER_NOTI_OPN WHERE DEL_YN = 'N' AND USER_NOTI_SEQ = N.USER_NOTI_SEQ) OPN_CNT
					 , N.*   
		        FROM(
		        SELECT   		NOTI_TITLE,   
					        <choose>
								   <when test="orderSeq == 1">
									  ROW_NUMBER() OVER (ORDER BY UPD_DTTM DESC) PNUM,
								   </when>
									<when test="orderSeq == 2">
									  ROW_NUMBER() OVER (ORDER BY UPDR_NAME ) PNUM,
									</when>
									<when test="orderSeq == 3">
									  ROW_NUMBER() OVER (ORDER BY NOTI_TITLE ) PNUM,
									</when>
									<otherwise>
									  ROW_NUMBER() OVER (ORDER BY UPD_DTTM DESC) PNUM,
									</otherwise> 
								</choose>	                        
		                         USER_NOTI_SEQ
		                        , UP_USER_NOTI_SEQ
		                        , BOARD_ID
		                        , EMGC_YN
		                        , ANMT_YN
		                        , POPUP_YN
		                        , BRIEF_YN
		                        , MOBL_OPEN_DIV
		                        , TITLE_BOLD_YN
		                        , TITLE_COLOR_DIV
		                        , LINK_URL
		                        , NOTI_TP
		                        , NOTI_KIND
		                        , NICK_USE_YN
		                        , USER_NICK
		                        , USER_NAME
		                        , EDIT_DIV
		                        , RSRV_YN
		                        , TO_CHAR (NOTI_BGN_DTTM, 'yyyy-mm-dd hh24:mi') NOTI_BGN_DTTM
		                        , TO_CHAR (NOTI_END_DTTM, 'yyyy-mm-dd') NOTI_END_DTTM
		                        , NOTI_OPEN_DIV
		                        , NOTI_OPEN_DIV_SPEC
		                        , PUBL_ASGN_DIV
		                        , PUBL_ASGN_DIV_SPEC
		                        , REPLY_PRMS_YN
		                        , REPLY_MAKR_REALNAME_YN
		                        , OPN_PRMS_YN
		                        , OPN_MAKR_REALNAME_YN
		                        , NOTI_READ_CNT
		                        , NOTI_AGRM_CNT
		                        , NOTI_OPP_CNT
		                        , NOTI_LIKE_CNT    
									<![CDATA[		                                             
		                        ,     CASE WHEN REG_DTTM < UPD_DTTM THEN 'Y' 
		                              WHEN  REG_DTTM =  UPD_DTTM THEN 'N' 
		                              ELSE 'X'
		                              END UPD_YN
		                              ]]>
		                        , STAT_CODE
		                        , DEPT_CODE
		                        , DEPT_NAME
		                        , DEPT_FNAME
		                        , MAKR_IP
		                        , DEL_YN
		                        , REGR_ID
		                        , REGR_NAME
		                        , TO_CHAR(REG_DTTM,'yyyy-mm-dd') REG_DTTM             
		                        , UPDR_ID
		                        , UPDR_NAME
		                        , UPD_DTTM
		                    FROM (
		                            SELECT A.*
		                            FROM PBS_USER_NOTI_INFO A 
		                            WHERE DEL_YN='N' 
		                            AND BOARD_ID = #{boardId}
		                            <![CDATA[	
		                            AND (NOTI_BGN_DTTM <= SYSDATE  OR (RSRV_YN = 'Y' AND REGR_ID = #{userId} AND REG_DTTM <= SYSDATE)) 
		                            AND NOTI_END_DTTM >= SYSDATE
		                            ]]>
		                            <if test="searchCondition !=null and searchCondition !=''">
			                            <if test="searchKeyword !=null and searchKeyword !=''">
			                            	<if test="!searchCondition.equalsIgnoreCase('MY_NOTI_TITLE') ">
			                            		/* 키워드 검색 */
												AND ${searchCondition} LIKE '%' || #{searchKeyword} || '%'
											</if>
											<if test="searchCondition.equalsIgnoreCase('MY_NOTI_TITLE') ">
			                            		/* 내게시글 검색 */
			                            		AND REGR_ID = #{userId}
			                            		AND NOTI_TITLE LIKE '%' || #{searchKeyword} || '%'
			                            	</if>
			                            </if>
			                        </if>	                       
			                        <if test="regDttmFrom != null and regDttmFrom != '' "> 
			                        	<![CDATA[ AND UPD_DTTM >= TO_DATE(#{regDttmFrom},'yyyy-mm-dd') ]]>
			                        </if>
			                        <if test="regDttmTo != null and regDttmTo != '' ">
			                        	<![CDATA[ AND UPD_DTTM <= TO_DATE(#{regDttmTo}|| '23:59:59','yyyy-mm-dd hh24:mi:ss') ]]>
			                        </if>
			                        AND EXISTS(SELECT 1 
	                        			 		FROM PBS_USER_BOARD_INFO C 
	                        				   WHERE A.BOARD_ID = C.BOARD_ID 
	                        			  		 AND C.BOARD_FORM_SPEC = #{boardFormSpec}) 
		                            AND EXISTS(
		                            			SELECT 1
		                                         FROM PBS_USER_BOARD_PART_INFO B
		                                        WHERE A.BOARD_ID = B.BOARD_ID
		                                          AND B.USER_ID IN 
		                                          (${userMap})
		                                       )
		                            ) X			
		                            <if test="searchCondition !=null and searchCondition !=''">
			                            <if test="searchKeyword !=null and searchKeyword !=''">
			                            ORDER BY UPD_DTTM DESC
			                            </if>
			                        </if>  
		) N
		WHERE PNUM BETWEEN #{firstIndex} - 1 AND #{firstIndex} + 1
		ORDER BY PNUM  		
		
	</select>	
	
	<!-- BBS_게시물_평가_정보 등록 건수 -->
	<select id="getPbsNotiEvalInfoCntForView" parameterType="portalxpert.board.board100.vo.PbsNotiEvalInfoVO"
										resultType="int">
		SELECT COUNT(USER_NOTI_SEQ) CNT
		FROM PBS_USER_NOTI_EVAL_INFO
		WHERE USER_NOTI_SEQ = #{userNotiSeq} 
		AND USER_ID = #{userId}  
		<if test="notiEvalDiv == '010' or notiEvalDiv == '020' ">
			AND NOTI_EVAL_DIV IN ('010','020') 
		</if>
		<if test="notiEvalDiv != '010' and notiEvalDiv != '020' ">
			AND NOTI_EVAL_DIV = #{notiEvalDiv}
		</if>
		
	</select>
	
	<!-- 게시글 읽음, 찬성, 반대, 좋아요 올리기 -->
	<update id="updatePbsNotiInfoForCntPlus" parameterType="portalxpert.board.board100.vo.PbsNotiEvalInfoVO">
		UPDATE PBS_USER_NOTI_INFO SET 
		<if test="notiEvalDiv == '010' ">
			NOTI_AGRM_CNT = NVL(NOTI_AGRM_CNT,0)+1
		</if>
		<if test="notiEvalDiv == '020' ">
			NOTI_OPP_CNT = NVL(NOTI_OPP_CNT,0)+1
		</if>
		<if test="notiEvalDiv == '030' ">
			NOTI_LIKE_CNT = NVL(NOTI_LIKE_CNT,0)+1
		</if>
		<if test="notiEvalDiv == '040' ">
			NOTI_READ_CNT = NVL(NOTI_READ_CNT,0)+1
		</if>
		WHERE USER_NOTI_SEQ = #{userNotiSeq}
		 
	</update>	
	
	<!-- BBS_게시물_평가_정보 등록 -->
	<insert id="insertPbsNotiEvalInfoForView" parameterType="portalxpert.board.board100.vo.PbsNotiEvalInfoVO">
		<![CDATA[
		INSERT INTO PBS_USER_NOTI_EVAL_INFO(
		  USER_NOTI_SEQ
		, NOTI_EVAL_DIV
		, USER_ID
		, USER_NAME
		, EVAL_DTTM
		, DEL_YN
		, REGR_ID
		, REGR_NAME
		, REG_DTTM
		, UPDR_ID
		, UPDR_NAME
		, UPD_DTTM
		) VALUES (
		 #{userNotiSeq}
		, #{notiEvalDiv}
		, #{userId}
		, #{userName}
		, sysdate
		, 'N'
		, #{regrId}
		, #{regrName}
		, sysdate
		, #{updrId}
		, #{updrName}
		, sysdate
		)
		]]>
	</insert>			
</mapper>